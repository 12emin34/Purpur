From a0e09aac9b0c78e4791feb0d6daad4f83f6cc348 Mon Sep 17 00:00:00 2001
From: William Blake Galbreath <blake.galbreath@gmail.com>
Date: Sat, 1 Jun 2019 01:16:35 -0500
Subject: [PATCH] Always place dragon egg when dragon is killed

---
 .../java/net/minecraft/server/EnderDragonBattle.java  |  2 +-
 src/main/java/net/pl3x/purpur/PurpurConfig.java       | 11 +++++++++++
 2 files changed, 12 insertions(+), 1 deletion(-)

diff --git a/src/main/java/net/minecraft/server/EnderDragonBattle.java b/src/main/java/net/minecraft/server/EnderDragonBattle.java
index 6700c8c65..c7470d285 100644
--- a/src/main/java/net/minecraft/server/EnderDragonBattle.java
+++ b/src/main/java/net/minecraft/server/EnderDragonBattle.java
@@ -356,7 +356,7 @@ public class EnderDragonBattle {
             this.bossBattle.setVisible(false);
             this.a(true);
             this.n();
-            if (!this.l) {
+            if (net.pl3x.purpur.PurpurConfig.enderDragonAlwaysDropsEggBlock || !this.l) { // Purpur - always place dragon egg
                 this.d.setTypeUpdate(this.d.getHighestBlockYAt(HeightMap.Type.MOTION_BLOCKING, WorldGenEndTrophy.a), Blocks.DRAGON_EGG.getBlockData());
             }
 
diff --git a/src/main/java/net/pl3x/purpur/PurpurConfig.java b/src/main/java/net/pl3x/purpur/PurpurConfig.java
index 4c25d358f..b450ffc53 100644
--- a/src/main/java/net/pl3x/purpur/PurpurConfig.java
+++ b/src/main/java/net/pl3x/purpur/PurpurConfig.java
@@ -142,6 +142,17 @@ public class PurpurConfig {
         feedMushroomsToCows = getInt("settings.mobs.cow.feed-mushrooms-for-mooshroom", feedMushroomsToCows);
     }
 
+    public static boolean enderDragonAlwaysDropsEggBlock = false;
+    private static void enderDragonSettings() {
+        if (version < 2) {
+            boolean oldValue = config.getBoolean("ender-dragon-death-always-places-egg-block", enderDragonAlwaysDropsEggBlock);
+            oldValue = config.getBoolean("settings.ender-dragon-death-always-places-egg-block", oldValue);
+
+            set("settings.mobs.ender-dragon.always-drop-egg-block", oldValue);
+        }
+        enderDragonAlwaysDropsEggBlock = getBoolean("settings.mobs.ender-dragon.always-drop-egg-block", enderDragonAlwaysDropsEggBlock);
+    }
+
     public static boolean giantsNaturallySpawn = true;
     public static boolean giantsHaveAI = true;
     private static void giantsSettings() {
-- 
2.23.0.rc1

