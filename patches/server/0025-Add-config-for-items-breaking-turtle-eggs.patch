From 22f8029702025d6bd1ded97cefadcea661af8fc6 Mon Sep 17 00:00:00 2001
From: William Blake Galbreath <blake.galbreath@gmail.com>
Date: Thu, 6 Jun 2019 22:15:46 -0500
Subject: [PATCH] Add config for items breaking turtle eggs

---
 .../java/net/minecraft/server/BlockTurtleEgg.java   | 13 ++++++++++++-
 .../java/net/pl3x/purpur/PurpurWorldConfig.java     |  5 +++++
 2 files changed, 17 insertions(+), 1 deletion(-)

diff --git a/src/main/java/net/minecraft/server/BlockTurtleEgg.java b/src/main/java/net/minecraft/server/BlockTurtleEgg.java
index 0118a8451..83e69425b 100644
--- a/src/main/java/net/minecraft/server/BlockTurtleEgg.java
+++ b/src/main/java/net/minecraft/server/BlockTurtleEgg.java
@@ -163,6 +163,17 @@ public class BlockTurtleEgg extends Block {
     }
 
     private boolean a(World world, Entity entity) {
-        return entity instanceof EntityTurtle ? false : (entity instanceof EntityLiving && !(entity instanceof EntityHuman) ? world.getGameRules().getBoolean(GameRules.MOB_GRIEFING) : true);
+        // Purpur start
+        if (entity instanceof EntityTurtle) {
+            return false;
+        }
+        if (!world.purpurConfig.itemsCanBreakTurtleEggs && entity instanceof EntityItem) {
+            return false;
+        }
+        if (entity instanceof EntityLiving && !(entity instanceof EntityHuman)) {
+            return world.getGameRules().getBoolean(GameRules.MOB_GRIEFING);
+        }
+        return true;
+        // Purpur end
     }
 }
diff --git a/src/main/java/net/pl3x/purpur/PurpurWorldConfig.java b/src/main/java/net/pl3x/purpur/PurpurWorldConfig.java
index f090f76a1..9dfba251e 100644
--- a/src/main/java/net/pl3x/purpur/PurpurWorldConfig.java
+++ b/src/main/java/net/pl3x/purpur/PurpurWorldConfig.java
@@ -101,4 +101,9 @@ public class PurpurWorldConfig {
     private void allowSignColors() {
         allowSignColors = getBoolean("allow-sign-colors", allowSignColors);
     }
+
+    public boolean itemsCanBreakTurtleEggs = false;
+    private void itemsCanBreakTurtleEggs() {
+        itemsCanBreakTurtleEggs = getBoolean("items-can-break-turtle-eggs", itemsCanBreakTurtleEggs);
+    }
 }
-- 
2.20.1

