From 939a05a47fad8fee743409e57cf78a26a1f3bae3 Mon Sep 17 00:00:00 2001
From: William Blake Galbreath <blake.galbreath@gmail.com>
Date: Fri, 5 Jul 2019 11:09:25 -0500
Subject: [PATCH] Illusioners naturally spawn

---
 .../server/EntityIllagerIllusioner.java       | 27 ++++++++++++++++---
 .../net/minecraft/server/SpawnerCreature.java |  4 +++
 .../net/pl3x/purpur/PurpurWorldConfig.java    |  8 ++++++
 3 files changed, 36 insertions(+), 3 deletions(-)

diff --git a/src/main/java/net/minecraft/server/EntityIllagerIllusioner.java b/src/main/java/net/minecraft/server/EntityIllagerIllusioner.java
index 3e6722cfc..9af93c636 100644
--- a/src/main/java/net/minecraft/server/EntityIllagerIllusioner.java
+++ b/src/main/java/net/minecraft/server/EntityIllagerIllusioner.java
@@ -58,9 +58,9 @@ public class EntityIllagerIllusioner extends EntityIllagerWizard implements IRan
     @Override
     protected void initAttributes() {
         super.initAttributes();
-        this.getAttributeInstance(GenericAttributes.MOVEMENT_SPEED).setValue(0.5D);
-        this.getAttributeInstance(GenericAttributes.FOLLOW_RANGE).setValue(18.0D);
-        this.getAttributeInstance(GenericAttributes.MAX_HEALTH).setValue(32.0D);
+        this.getAttributeInstance(GenericAttributes.MOVEMENT_SPEED).setValue(world.purpurConfig.illusionerMovementSpeed); // Purpur
+        this.getAttributeInstance(GenericAttributes.FOLLOW_RANGE).setValue(world.purpurConfig.illusionerFollowRange); // Purpur
+        this.getAttributeInstance(GenericAttributes.MAX_HEALTH).setValue(world.purpurConfig.illusionerMaxHealth); // Purpur
     }
 
     @Override
@@ -253,4 +253,25 @@ public class EntityIllagerIllusioner extends EntityIllagerWizard implements IRan
             return EntityIllagerWizard.Spell.DISAPPEAR;
         }
     }
+
+    // Purpur start
+    static {
+        Biomes.addSpawn("plains", EnumCreatureType.MONSTER, EntityTypes.ILLUSIONER, 5, 1, 1);
+        Biomes.addSpawn("sunflower_plains", EnumCreatureType.MONSTER, EntityTypes.ILLUSIONER, 5, 1, 1);
+        Biomes.addSpawn("desert", EnumCreatureType.MONSTER, EntityTypes.ILLUSIONER, 5, 1, 1);
+        Biomes.addSpawn("desert_hills", EnumCreatureType.MONSTER, EntityTypes.ILLUSIONER, 5, 1, 1);
+        Biomes.addSpawn("desert_lakes", EnumCreatureType.MONSTER, EntityTypes.ILLUSIONER, 5, 1, 1);
+        Biomes.addSpawn("mountains", EnumCreatureType.MONSTER, EntityTypes.ILLUSIONER, 5, 1, 1);
+        Biomes.addSpawn("gravelly_mountains", EnumCreatureType.MONSTER, EntityTypes.ILLUSIONER, 5, 1, 1);
+        Biomes.addSpawn("modified_gravelly_mountains", EnumCreatureType.MONSTER, EntityTypes.ILLUSIONER, 5, 1, 1);
+        Biomes.addSpawn("savanna", EnumCreatureType.MONSTER, EntityTypes.ILLUSIONER, 5, 1, 1);
+        Biomes.addSpawn("savanna_plateau", EnumCreatureType.MONSTER, EntityTypes.ILLUSIONER, 5, 1, 1);
+        Biomes.addSpawn("shattered_savanna", EnumCreatureType.MONSTER, EntityTypes.ILLUSIONER, 5, 1, 1);
+        Biomes.addSpawn("shattered_savanna_plateau", EnumCreatureType.MONSTER, EntityTypes.ILLUSIONER, 5, 1, 1);
+        Biomes.addSpawn("badlands", EnumCreatureType.MONSTER, EntityTypes.ILLUSIONER, 10, 1, 1);
+        Biomes.addSpawn("badlands_plateau", EnumCreatureType.MONSTER, EntityTypes.ILLUSIONER, 10, 1, 1);
+        Biomes.addSpawn("eroded_badlands", EnumCreatureType.MONSTER, EntityTypes.ILLUSIONER, 10, 1, 1);
+        Biomes.addSpawn("modified_badlands_plateau", EnumCreatureType.MONSTER, EntityTypes.ILLUSIONER, 10, 1, 1);
+    }
+    // Purpur end
 }
diff --git a/src/main/java/net/minecraft/server/SpawnerCreature.java b/src/main/java/net/minecraft/server/SpawnerCreature.java
index 71920d7f8..2e868f5d5 100644
--- a/src/main/java/net/minecraft/server/SpawnerCreature.java
+++ b/src/main/java/net/minecraft/server/SpawnerCreature.java
@@ -82,6 +82,10 @@ public final class SpawnerCreature {
                                                     if (!worldserver.purpurConfig.giantNaturallySpawn) {
                                                         return i;
                                                     }
+                                                } else if (entitytypes == EntityTypes.ILLUSIONER) {
+                                                    if (!worldserver.purpurConfig.illusionerNaturallySpawn) {
+                                                        return i;
+                                                    }
                                                 }
                                                 // Purpur end
 
diff --git a/src/main/java/net/pl3x/purpur/PurpurWorldConfig.java b/src/main/java/net/pl3x/purpur/PurpurWorldConfig.java
index 8cdcca3bd..8d6d25272 100644
--- a/src/main/java/net/pl3x/purpur/PurpurWorldConfig.java
+++ b/src/main/java/net/pl3x/purpur/PurpurWorldConfig.java
@@ -288,10 +288,18 @@ public class PurpurWorldConfig {
     public boolean illusionerRidable = false;
     public boolean illusionerRidableInWater = false;
     public boolean illusionerRequireShiftToMount = true;
+    public boolean illusionerNaturallySpawn = false;
+    public double illusionerMaxHealth = 32.0D;
+    public double illusionerMovementSpeed = 0.5D;
+    public double illusionerFollowRange = 18.0D;
     private void illusionerSettings() {
         illusionerRidable = getBoolean("mobs.illusioner.ridable", illusionerRidable);
         illusionerRidableInWater = getBoolean("mobs.illusioner.ridable-in-water", illusionerRidableInWater);
         illusionerRequireShiftToMount = getBoolean("mobs.illusioner.require-shift-to-mount", illusionerRequireShiftToMount);
+        illusionerNaturallySpawn = getBoolean("mobs.illusioner.naturally-spawn", illusionerNaturallySpawn);
+        illusionerMaxHealth = getDouble("mobs.illusioner.max-health", illusionerMaxHealth);
+        illusionerMovementSpeed = getDouble("mobs.illusioner.movement-speed", illusionerMovementSpeed);
+        illusionerFollowRange = getDouble("mobs.illusioner.follow-range", illusionerFollowRange);
     }
 
     public boolean ironGolemRidable = false;
-- 
2.24.0

