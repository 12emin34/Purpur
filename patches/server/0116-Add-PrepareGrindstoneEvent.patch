From a6e29f80bc005ad2d1fdb68c5ced8e5066979dbd Mon Sep 17 00:00:00 2001
From: William Blake Galbreath <Blake.Galbreath@GMail.com>
Date: Thu, 18 Jun 2020 23:29:54 -0500
Subject: [PATCH] Add PrepareGrindstoneEvent

---
 .../java/net/minecraft/server/ContainerGrindstone.java   | 1 +
 .../org/bukkit/craftbukkit/event/CraftEventFactory.java  | 9 +++++++++
 2 files changed, 10 insertions(+)

diff --git a/src/main/java/net/minecraft/server/ContainerGrindstone.java b/src/main/java/net/minecraft/server/ContainerGrindstone.java
index fcfb4abdc2..0ebdcf0adf 100644
--- a/src/main/java/net/minecraft/server/ContainerGrindstone.java
+++ b/src/main/java/net/minecraft/server/ContainerGrindstone.java
@@ -161,6 +161,7 @@ public class ContainerGrindstone extends Container {
         super.a(iinventory);
         if (iinventory == this.craftInventory) {
             this.e();
+            org.bukkit.craftbukkit.event.CraftEventFactory.callPrepareGrindstoneEvent(getBukkitView(), resultInventory.getItem(0)); // Purpur
         }
 
     }
diff --git a/src/main/java/org/bukkit/craftbukkit/event/CraftEventFactory.java b/src/main/java/org/bukkit/craftbukkit/event/CraftEventFactory.java
index ce8d7877ad..a7e0331816 100644
--- a/src/main/java/org/bukkit/craftbukkit/event/CraftEventFactory.java
+++ b/src/main/java/org/bukkit/craftbukkit/event/CraftEventFactory.java
@@ -1521,6 +1521,15 @@ public class CraftEventFactory {
         return event;
     }
 
+    // Purpur start
+    public static net.pl3x.purpur.event.inventory.PrepareGrindstoneEvent callPrepareGrindstoneEvent(InventoryView view, ItemStack item) {
+        net.pl3x.purpur.event.inventory.PrepareGrindstoneEvent event = new net.pl3x.purpur.event.inventory.PrepareGrindstoneEvent(view, CraftItemStack.asCraftMirror(item).clone());
+        event.getView().getPlayer().getServer().getPluginManager().callEvent(event);
+        event.getInventory().setItem(2, event.getResult());
+        return event;
+    }
+    // Purpur end
+
     /**
      * Mob spawner event.
      */
-- 
2.26.2

