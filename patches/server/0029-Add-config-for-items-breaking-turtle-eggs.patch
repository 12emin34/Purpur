From 86ab92142299a1e2412d3aeebea99d4cabac9508 Mon Sep 17 00:00:00 2001
From: William Blake Galbreath <blake.galbreath@gmail.com>
Date: Thu, 6 Jun 2019 22:15:46 -0500
Subject: [PATCH] Add config for items breaking turtle eggs

---
 .../java/net/minecraft/server/BlockTurtleEgg.java   | 13 ++++++++++++-
 .../java/net/pl3x/purpur/PurpurWorldConfig.java     |  5 +++++
 2 files changed, 17 insertions(+), 1 deletion(-)

diff --git a/src/main/java/net/minecraft/server/BlockTurtleEgg.java b/src/main/java/net/minecraft/server/BlockTurtleEgg.java
index a32ea2a4f..37a394d92 100644
--- a/src/main/java/net/minecraft/server/BlockTurtleEgg.java
+++ b/src/main/java/net/minecraft/server/BlockTurtleEgg.java
@@ -163,6 +163,17 @@ public class BlockTurtleEgg extends Block {
     }
 
     private boolean a(World world, Entity entity) {
-        return entity instanceof EntityTurtle ? false : (entity instanceof EntityLiving && !(entity instanceof EntityHuman) ? world.getGameRules().getBoolean("mobGriefing") : true);
+        // Purpur start
+        if (entity instanceof EntityTurtle) {
+            return false;
+        }
+        if (!world.purpurConfig.itemsCanBreakTurtleEggs && entity instanceof EntityItem) {
+            return false;
+        }
+        if (entity instanceof EntityLiving && !(entity instanceof EntityHuman)) {
+            return world.getGameRules().getBoolean("mobGriefing");
+        }
+        return true;
+        // Purpur end
     }
 }
diff --git a/src/main/java/net/pl3x/purpur/PurpurWorldConfig.java b/src/main/java/net/pl3x/purpur/PurpurWorldConfig.java
index 7f1c3ccb6..a649a4c35 100644
--- a/src/main/java/net/pl3x/purpur/PurpurWorldConfig.java
+++ b/src/main/java/net/pl3x/purpur/PurpurWorldConfig.java
@@ -101,4 +101,9 @@ public class PurpurWorldConfig {
     private void allowSignColors() {
         allowSignColors = getBoolean("allow-sign-colors", allowSignColors);
     }
+
+    public boolean itemsCanBreakTurtleEggs = false;
+    private void itemsCanBreakTurtleEggs() {
+        itemsCanBreakTurtleEggs = getBoolean("items-can-break-turtle-eggs", itemsCanBreakTurtleEggs);
+    }
 }
-- 
2.20.1

