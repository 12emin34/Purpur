From 7a219781d500be21e684c902ea24fb0b97a3697c Mon Sep 17 00:00:00 2001
From: William Blake Galbreath <blake.galbreath@gmail.com>
Date: Thu, 6 Jun 2019 21:30:49 -0500
Subject: [PATCH] Campfires burn out in rain

---
 src/main/java/net/minecraft/server/BlockCampfire.java | 3 +++
 src/main/java/net/pl3x/purpur/PurpurWorldConfig.java  | 5 +++++
 2 files changed, 8 insertions(+)

diff --git a/src/main/java/net/minecraft/server/BlockCampfire.java b/src/main/java/net/minecraft/server/BlockCampfire.java
index eca3487b0..d787fa006 100644
--- a/src/main/java/net/minecraft/server/BlockCampfire.java
+++ b/src/main/java/net/minecraft/server/BlockCampfire.java
@@ -86,6 +86,9 @@ public class BlockCampfire extends BlockTileEntity implements IBlockWaterlogged
         if (iblockdata.get(BlockCampfire.d) && iblockdata.get(BlockCampfire.b)) {
             world.setTypeAndData(pos, iblockdata.set(BlockCampfire.b, false), 3);
         }
+        if (world.purpurConfig.campfiresGoOutInRain && world.getTime() % 20 == 0L && iblockdata.get(BlockCampfire.b) && world.isRainingAt(pos.shift(EnumDirection.UP))) {
+            world.setTypeAndData(pos, iblockdata.set(BlockCampfire.b, false), 3);
+        }
         world.getBlockTickList().a(pos, this, tickRate(world));
     }
 
diff --git a/src/main/java/net/pl3x/purpur/PurpurWorldConfig.java b/src/main/java/net/pl3x/purpur/PurpurWorldConfig.java
index 1238864e7..f090f76a1 100644
--- a/src/main/java/net/pl3x/purpur/PurpurWorldConfig.java
+++ b/src/main/java/net/pl3x/purpur/PurpurWorldConfig.java
@@ -92,6 +92,11 @@ public class PurpurWorldConfig {
         campfireRegenBoostRequireLineOfSight = getBoolean("campfire-regen.boost-require-line-of-sight", campfireRegenBoostRequireLineOfSight);
     }
 
+    public boolean campfiresGoOutInRain = true;
+    private void campfiresGoOutInRain() {
+        campfiresGoOutInRain = getBoolean("campfires-go-out-in-rain", campfiresGoOutInRain);
+    }
+
     public boolean allowSignColors = true;
     private void allowSignColors() {
         allowSignColors = getBoolean("allow-sign-colors", allowSignColors);
-- 
2.20.1

