From 878f46588f40c083ede79636abf7da2da89ab0fb Mon Sep 17 00:00:00 2001
From: William Blake Galbreath <blake.galbreath@gmail.com>
Date: Mon, 22 Jul 2019 14:24:26 -0500
Subject: [PATCH] Implement a hard limit for pillager outpost spawns

---
 .../java/net/minecraft/server/ChunkProviderGenerate.java     | 1 +
 src/main/java/net/pl3x/purpur/PurpurWorldConfig.java         | 5 +++++
 2 files changed, 6 insertions(+)

diff --git a/src/main/java/net/minecraft/server/ChunkProviderGenerate.java b/src/main/java/net/minecraft/server/ChunkProviderGenerate.java
index b794a39d3..39159e34a 100644
--- a/src/main/java/net/minecraft/server/ChunkProviderGenerate.java
+++ b/src/main/java/net/minecraft/server/ChunkProviderGenerate.java
@@ -142,6 +142,7 @@ public class ChunkProviderGenerate extends ChunkGeneratorAbstract<GeneratorSetti
             }
         } else if (enumcreaturetype == EnumCreatureType.MONSTER) {
             if (WorldGenerator.PILLAGER_OUTPOST.a(this.a, blockposition)) {
+                if (getWorld().purpurConfig.limitPillagerOutpostSpawns > 0 && getWorld().getEntitiesByClass(EntityPillager.class, new AxisAlignedBB(blockposition).grow(128)).size() < getWorld().purpurConfig.limitPillagerOutpostSpawns) // Purpur
                 return WorldGenerator.PILLAGER_OUTPOST.e();
             }
 
diff --git a/src/main/java/net/pl3x/purpur/PurpurWorldConfig.java b/src/main/java/net/pl3x/purpur/PurpurWorldConfig.java
index a3f93485b..9200c439b 100644
--- a/src/main/java/net/pl3x/purpur/PurpurWorldConfig.java
+++ b/src/main/java/net/pl3x/purpur/PurpurWorldConfig.java
@@ -116,4 +116,9 @@ public class PurpurWorldConfig {
     private void milkCuresBadOmen() {
         milkCuresBadOmen = getBoolean("milk-cures-bad-omen", milkCuresBadOmen);
     }
+
+    public int limitPillagerOutpostSpawns = 10;
+    private void limitPillagerOutpostSpawns() {
+        limitPillagerOutpostSpawns = getInt("limit-pillager-outpost-spawns", limitPillagerOutpostSpawns);
+    }
 }
-- 
2.20.1

